package shared

import (
	. "github.com/smartystreets/goconvey/convey"
	"testing"
)

func TestReadPemKey(t *testing.T) {
	Convey("Reading a pem key", t, func() {
		recipientPvtKey, err := testsReadPemKey("recipient.pem")
		So(err, ShouldBeNil)
		So(recipientPvtKey.D.String(), ShouldEqual, "12228172427132810572042578383962536770439023846612763464844944334508177767699071210229457732481440427328435194826365165609123048899819079259564480190352046012231868804347979207063953386959883568047336760319118761989076952321638781000218078696137776472714960263248266046437814698359274320977714278826676800711269546833170309036216766934387350778548056558622436209107045081149292616873213558232931896200840130642291223738873468545050826597335376121892099906101996717375457922622484533896913032315045681179864669019586792951645892329834140898817093196774001976081988459408219274912979991187070666317070545815495302240873")
		So(recipientPvtKey.E, ShouldEqual, 65537)
		So(recipientPvtKey.N.String(), ShouldEqual, "20965277602537684930280038183119758595794958949259926205246386313948003828952100193716362888518931622912325895705310499896013008652647298821035378371094886579558927032846396685241342396891821828623108155945953860156393361002046848670014185049281398474619237430281271730160760284797168376034439782641305885892100653750377927285554826810256790268260199383314495480770790807001752803923899003045517780057244185590974847984271233018951882572964363398682276203440972173179569719444422144712829762059453449237052572588425906556500676176380087246558122817848613994641124505887144167250245405982010015270591594849214404845823")
		So(len(recipientPvtKey.Primes), ShouldEqual, 2)
		So(recipientPvtKey.Primes[0].String(), ShouldEqual, "149517416600304439488432896684563240698642439800194267474512246667705813773528802010597188521841671966419439696449440025336929370991121247352453841764132928258480067591595186787593731994455233318739476907588238248447515010062912904340918646727038857460799323033352948001313378683076675567335956206422502680117")
		So(recipientPvtKey.Primes[1].String(), ShouldEqual, "140219635138445781147145919355253633874075382168621636154397239646507677344096899114406329107293693692473264921581099519789027166405719720971613034110938424342008268598156744766256582090344224878815625084718383816960503334522796524407502749617905614446897382612157036908265717752117113191238572295895482990819")

		senderPvtKey, err := testsReadPemKey("sender.pem")
		So(err, ShouldBeNil)
		So(senderPvtKey.D.String(), ShouldEqual, "4656700069430972585321683067962056564430322740741847344312670561829919794062414236460890593840701438193057928147523949131173546171422890202139421184742484134944285058805450548664159455249812315933663438187268068702200371735642263826001770300872567451797489030444827016365387933879700319250106528969887343002253199310072365442821214072766762327279602547249209818091559933457637104896019766028748201183644579079605694871002608057100702161785178397338890637345489759373334723484824097372846899230045868431860511333404398987759209239659744904347270900635566402493630775066471891516814979853551944318501851547713313569793")
		So(senderPvtKey.E, ShouldEqual, 65537)
		So(senderPvtKey.N.String(), ShouldEqual, "21029916789573983622121495536454610051203835547133299986509060819366555508783657787688629192980846896007334443012973887417979651008581998013892726446008005977938506746067586315311674353549266107314257218059467159491187001270588963917080899959225844341817257344836178898259263300900904067164707248421961604075446770982136684213560308451756488037269337360090885755455881120941327742730947366669772246532782565128608106400959496470252554122366416617233312751189379821066088394613696117280455494127358024306142910796906407571325363819381765888872619671327743826422548961449907153703695040361098623271818576789070014719437")
		So(len(senderPvtKey.Primes), ShouldEqual, 2)
		So(senderPvtKey.Primes[0].String(), ShouldEqual, "153398072831929212945516474792906307510117845946491861004239220354931789323233914125928058443669128499769441978022010457124512942443754737425856611858888202962368287317012791126586308467775598879929667981009718416586545894786393760040970548093789680548963876196910694410555146308782838111367941398228699115697")
		So(senderPvtKey.Primes[1].String(), ShouldEqual, "137093748319872556694318803940200897143225017240351457277815869783394096766971486844693770436652385144541639563448930043019943221204688021869275619780370176534657416211724886963938973777035837814661262988352305440517808005936282975289263992655597246740103821090140315802407856107013016775551528108420737363421")
	})
}
